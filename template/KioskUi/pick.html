{% extends 'base_front.html' %}
{% load Common_extras %}
{% block title %}STEP 3{% endblock %}

{% block css %}
<style>
  .list-group {
    max-height: 600px;
    margin-bottom: 10px;
    overflow: auto;
    -webkit-overflow-scrolling: touch;
  }

  ::-webkit-scrollbar {
    width: 0px;
  }

  ::-webkit-scrollbar-track {
    -webkit-border-radius: 10px;
    border-radius: 10px;
    margin: 0px 0 5px 0;
  }

  ::-webkit-scrollbar-thumb {
    -webkit-border-radius: 4px;
    border-radius: 4px;
    background: rgb(219, 219, 219);
  }

  .list-group-item{
    font-size:24px;
    background-color: beige;
  }
  div>.list-group-item:hover{
    font-size:28px;
  }
  div>.list-group-item:focus{
    font-weight:bold;
    font-size:28px;
  }
</style>
{% endblock %}


{% block container %}
<div class="row">
  <div class="col-4 " style="top:100px;padding-left:100px;">
    <div class="list-group">
      {% for fee in Feelist %}
      <a href="#" id="{{fee.FeeID}}" class="list-group-item list-group-item-action">{{fee.FeeName}}<input type="hidden" value="{{fee.FeeAmount}}"></a>
      {% endfor %}
    </div>
  </div>
  <div class="right col-7 text-center" style="top:80px;">
    <ul class='list-group'>
    </ul>
    <ul class="list-group1">
      <li class="list-group-item d-flex justify-content-between align-items-center" style="line-height:0;padding: .15rem 1.25rem;">
        <b>金額總計</b>
        <span id="totalaccount" class="badge badge-primary badge-pill ">NT$0</span>
        <button  href="#" id="Checkout" class="btn btn-warning" ><i class="fas fa-coins"></i>投幣結帳</button >
      </li>
    </ul>
  </div>
</div>



{% endblock %}

{% block js %}
<script>
  $(".hero-post-area > .hero-post-slide > .container > .row > div").removeClass("center")
  $(".hero-post-area > .hero-post-slide > .container > .row >.three").addClass("center")
  $(function() {
    // Set NumPad defaults for jQuery mobile.
    // These defaults will be applied to all NumPads within this document!
    $.fn.numpad.defaults.gridTpl = '<table class="table modal-content"></table>';
    $.fn.numpad.defaults.backgroundTpl = '<div class="modal-backdrop in"></div>';
    $.fn.numpad.defaults.displayTpl = '<input type="text" class="form-control  input-lg" style="width: 100%;" />';
    $.fn.numpad.defaults.buttonNumberTpl = '<button type="button" class="btn btn-default btn-lg"></button>';
    $.fn.numpad.defaults.buttonFunctionTpl = '<button type="button" class="btn btn-lg" style="width: 100%;"></button>';
    $.fn.numpad.defaults.onKeypadCreate = function() {
      $(this).find('.done').addClass('btn-primary');
    };
    $("#pad").numpad({
      hidePlusMinusButton: true,
      hideDecimalButton: true,
      textDone: '確認',
      textDelete: '刪除',
      textClear: '清除',
      textCancel: '取消'
    });
  });
  $(".list-group > .list-group-item").click(function() {
    var price = $(this).children().val()
    var name = $(this).text()
    var id = $(this).attr("id")

    if (price == 0) {
      $("#pad").numpad('open')
      $('.done').on("click", function() {
        $(".right > .list-group").append("<li class='list-group-item d-flex justify-content-between align-items-center'>" + name + "<span class='badge badge-primary badge-pill' data-numpad='nmpd1'>NT$" + $('.nmpd-display').val() +
          "</span><input type='number' id='" + id +
          "' min='1' max='100' value='1'/><i onclick='removeitem(this,"+$('.nmpd-display').val()+")' class='fas fa-times fa-1x'></i></li>")
          var total=convert()
          total=total+ parseInt($('.nmpd-display').val());
          document.getElementById("totalaccount").innerHTML = 'NT$'+total;
      });

    } else {
      $(this).attr('hidden', true)
      $(".right > .list-group").append("<li class='list-group-item d-flex justify-content-between align-items-center'>" + name + "<span class='badge badge-primary badge-pill'>NT$" + price + "</span><input type='number' id='" + id +
        "' min='1' max='100' value='1'/><i onclick='removeitem(this,"+price+")' class='fas fa-times fa-1x'></i></li>")
        var total=convert()
        total=total+ parseInt(price);
        var i= document.getElementById("totalaccount").innerHTML
        document.getElementById("totalaccount").innerHTML = 'NT$'+total;
    }
  });
  function convert(){
    return parseInt(document.getElementById("totalaccount").innerHTML.substring(3, document.getElementById("totalaccount").innerHTML.length))
  }
  function removeitem(elem,minus) {
    elem.parentNode.remove()
    var feeid = $(elem.parentNode.childNodes[2]).attr("id")
    $("a[id='" + feeid + "']").attr('hidden', false)
    var total=convert()
    total=total- parseInt(minus);
    document.getElementById("totalaccount").innerHTML = 'NT$'+total;
  }


</script>
{% endblock %}
